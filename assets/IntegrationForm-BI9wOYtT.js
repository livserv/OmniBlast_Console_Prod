import{f as N,r as x,j as e,l as o,D as C,B as f,u as I,e as w,P as E,t as T}from"../index.ChXpIm8i.js";import{L as P}from"./LoadingSpinner-BKInrR1l.js";import{u as k}from"./integration-dt0Vcpzg.js";const q=({onCancel:g,integration:a})=>{const n=N(),{createIntegration:b,updateIntegration:c,isLoading:v}=k(),u=!!a,[i,l]=x.useState(""),[t,r]=x.useState({provider:"smtp",fromEmail:"",fromName:""});x.useEffect(()=>{a&&(l(a.name||""),r(a.config))},[a]);const h=[{label:"SMTP",value:"smtp"},{label:"SendGrid",value:"sendgrid"},{label:"Mailgun",value:"mailgun"},{label:"AWS SES",value:"aws-ses"}],y=async s=>{s.preventDefault();try{u&&a?.id?await c(a.id,{name:i,config:t}):await b({type:"email",name:i,config:t}),n("/integrations")}catch(j){console.error(`Failed to ${u?"update":"create"} integration:`,j)}};return e.jsxs("form",{onSubmit:y,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your email service provider"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(o,{value:i,onChange:s=>l(s.value),placeholder:"e.g., Production Email Server",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider"}),e.jsx(C,{options:h,value:t.provider,onChange:s=>r({...t,provider:s})})]}),t.provider==="smtp"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMTP Host"}),e.jsx(o,{value:t.host||"",onChange:s=>r({...t,host:s.value}),placeholder:"smtp.example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMTP Port"}),e.jsx(o,{type:"number",value:t.port?.toString()||"",onChange:s=>r({...t,port:parseInt(s.value)}),placeholder:"587",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx(o,{value:t.username||"",onChange:s=>r({...t,username:s.value}),placeholder:"your-username",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx(o,{type:"password",value:t.password||"",onChange:s=>r({...t,password:s.value}),placeholder:"your-password",required:!0})]})]}),(t.provider==="sendgrid"||t.provider==="mailgun"||t.provider==="aws-ses")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx(o,{type:"password",value:t.apiKey||"",onChange:s=>r({...t,apiKey:s.value}),placeholder:"Enter your API key",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Email"}),e.jsx(o,{type:"email",value:t.fromEmail,onChange:s=>r({...t,fromEmail:s.value}),placeholder:"noreply@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Name"}),e.jsx(o,{value:t.fromName,onChange:s=>r({...t,fromName:s.value}),placeholder:"Your Company Name",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(f,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:v,children:v?u?"Updating...":"Creating...":u?"Update Integration":"Create Integration"})]})]})},U=({onCancel:g,integration:a})=>{const n=N(),{user:b}=I(),{createIntegration:c,updateIntegration:v,isLoading:u}=k(),i=!!a,[l,t]=x.useState({type:"gupshup"}),[r,h]=x.useState(!1);x.useEffect(()=>{a&&t(a)},[a]);const y=l.id&&b?.organizationId?`${w.apiExternalBasePath}/api/webhooks/gupshup/${b.organizationId}/${l.id}/callback`:"",s=async()=>{y&&(await navigator.clipboard.writeText(y),h(!0),setTimeout(()=>h(!1),2e3))},j=async m=>{m.preventDefault();try{i&&l.id?await v(l.id,{name:l.name,appId:l.appId,appName:l.appName,secret:l.secret,config:l.config}):await c(l),n("/integrations")}catch(d){console.error(`Failed to ${i?"update":"create"} integration:`,d)}};return e.jsxs("form",{onSubmit:j,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gupshup Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your Gupshup WhatsApp Business API connection"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(o,{value:l.name,onChange:m=>t(d=>({...d,name:m.value})),placeholder:"e.g., My Gupshup Account",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App Id"}),e.jsx(o,{value:l.appId,onChange:m=>t(d=>({...d,appId:m.value})),placeholder:"e.g., 3h0bg315-4n14-9d57-1y64-h594gys76732",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App Name"}),e.jsx(o,{value:l.appName,onChange:m=>t(d=>({...d,appName:m.value})),placeholder:"Your Gupshup app name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key / Secret"}),e.jsx(E,{value:l.secret,onChange:m=>t(d=>({...d,secret:m.value})),placeholder:"Enter your Gupshup API key",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Source Phone Number"}),e.jsx(o,{value:l.config?.phoneNumber,onChange:m=>t(d=>({...d,config:{...d.config,phoneNumber:m.value}})),placeholder:"e.g., 919876543210",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Gupshup registered phone number (with country code, without + sign)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Endpoint"}),e.jsx(o,{value:l.config?.apiVersion,onChange:m=>t(d=>({...d,config:{...d.config,apiVersion:m.value}})),placeholder:"v2 or v3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Callback URL (Optional)"}),e.jsx(o,{value:l.config?.callbackUrl||"",onChange:m=>t(d=>({...d,config:{...d.config,callbackUrl:m.value}})),placeholder:"https://your-server.com/webhook"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"URL to handle and respond to user queries"})]}),y&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Webhook URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:y,className:"flex-1 px-3 py-2 text-sm bg-white border border-gray-300 rounded-md font-mono text-gray-700"}),e.jsx(f,{type:"button",variant:"default",size:"sm",onClick:s,children:r?"Copied!":"Copy"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Configure this webhook URL in your Gupshup dashboard to receive delivery status updates and user responses."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," You can find your API key in your Gupshup dashboard under Settings → API Keys."]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(f,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:u,children:u?i?"Updating...":"Creating...":i?"Update Integration":"Create Integration"})]})]})},W=({onSelect:g})=>{const a=[{type:"email",title:"Email",description:"Connect SMTP, SendGrid, Mailgun, or AWS SES",color:"blue"},{type:"gupshup",title:"Gupshup",description:"WhatsApp Business API via Gupshup",color:"green"},{type:"whatsapp",title:"WhatsApp",description:"Direct WhatsApp Business API or Twilio",color:"green"},{type:"sms",title:"SMS",description:"Twilio, MessageBird, or AWS SNS",color:"purple"},{type:"telegram",title:"Telegram",description:"Telegram Bot API",color:"cyan"}];return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Channel Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(n=>e.jsxs("button",{onClick:()=>g(n.type),className:`bg-${n.color}-50 border-2 border-${n.color}-200 rounded-lg p-6 text-left hover:bg-${n.color}-100 transition-colors`,children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n.title}),e.jsx("p",{className:"text-sm text-gray-600",children:n.description})]},n.type))})]})},M=({onCancel:g,integration:a})=>{const n=N(),{createIntegration:b,updateIntegration:c,isLoading:v}=k(),u=!!a,[i,l]=x.useState(""),[t,r]=x.useState({provider:"twilio",fromNumber:""});x.useEffect(()=>{a&&(l(a.name||""),r(a.config))},[a]);const h=[{label:"Twilio",value:"twilio"},{label:"MessageBird",value:"messagebird"},{label:"AWS SNS",value:"aws-sns"}],y=async s=>{s.preventDefault();try{u&&a?.id?await c(a.id,{name:i,config:t}):await b({type:"sms",name:i,config:t}),n("/integrations")}catch(j){console.error(`Failed to ${u?"update":"create"} integration:`,j)}};return e.jsxs("form",{onSubmit:y,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"SMS Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your SMS service provider"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(o,{value:i,onChange:s=>l(s.value),placeholder:"e.g., Twilio SMS",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider"}),e.jsx(C,{options:h,value:t.provider,onChange:s=>r({...t,provider:s})})]}),t.provider==="twilio"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account SID"}),e.jsx(o,{value:t.accountSid||"",onChange:s=>r({...t,accountSid:s.value}),placeholder:"Enter your Twilio Account SID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auth Token"}),e.jsx(o,{type:"password",value:t.authToken||"",onChange:s=>r({...t,authToken:s.value}),placeholder:"Enter your Twilio Auth Token",required:!0})]})]}),(t.provider==="messagebird"||t.provider==="aws-sns")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx(o,{type:"password",value:t.apiKey||"",onChange:s=>r({...t,apiKey:s.value}),placeholder:"Enter your API key",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Number"}),e.jsx(o,{value:t.fromNumber,onChange:s=>r({...t,fromNumber:s.value}),placeholder:"+1234567890",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(f,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:v,children:v?u?"Updating...":"Creating...":u?"Update Integration":"Create Integration"})]})]})},F=({onCancel:g,integration:a})=>{const n=N(),{user:b}=I(),{createIntegration:c,updateIntegration:v,isLoading:u}=k(),i=!!a,[l,t]=x.useState(""),[r,h]=x.useState({provider:"whatsapp-business",fromNumber:""}),[y,s]=x.useState(!1);x.useEffect(()=>{a&&(t(a.name||""),h(a.config))},[a]);const j=a?.id&&b?.organizationId?`${w.apiExternalBasePath}/api/webhooks/whatsapp/${b.organizationId}/${a.id}/callback`:"",m=async()=>{j&&(await navigator.clipboard.writeText(j),s(!0),setTimeout(()=>s(!1),2e3))},d=[{label:"WhatsApp Business API",value:"whatsapp-business"},{label:"Twilio",value:"twilio"}],S=async p=>{p.preventDefault();try{i&&a?.id?await v(a.id,{name:l,config:r}):await c({type:"whatsapp",name:l,config:r}),n("/integrations")}catch(A){console.error(`Failed to ${i?"update":"create"} integration:`,A)}};return e.jsxs("form",{onSubmit:S,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"WhatsApp Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your WhatsApp Business API connection"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(o,{value:l,onChange:p=>t(p.value),placeholder:"e.g., WhatsApp Business Account",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider"}),e.jsx(C,{options:d,value:r.provider,onChange:p=>h({...r,provider:p})})]}),r.provider==="whatsapp-business"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number ID"}),e.jsx(o,{value:r.phoneNumberId||"",onChange:p=>h({...r,phoneNumberId:p.value}),placeholder:"Enter your phone number ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Token"}),e.jsx(o,{type:"password",value:r.accessToken||"",onChange:p=>h({...r,accessToken:p.value}),placeholder:"Enter your access token",required:!0})]})]}),r.provider==="twilio"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account SID"}),e.jsx(o,{value:r.accountSid||"",onChange:p=>h({...r,accountSid:p.value}),placeholder:"Enter your Twilio Account SID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auth Token"}),e.jsx(o,{type:"password",value:r.authToken||"",onChange:p=>h({...r,authToken:p.value}),placeholder:"Enter your Twilio Auth Token",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Number"}),e.jsx(o,{value:r.fromNumber,onChange:p=>h({...r,fromNumber:p.value}),placeholder:"+1234567890",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Callback URL (Optional)"}),e.jsx(o,{value:r.callbackUrl||"",onChange:p=>h({...r,callbackUrl:p.value}),placeholder:"https://your-server.com/webhook"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"URL to handle and respond to user queries"})]}),j&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Webhook URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:j,className:"flex-1 px-3 py-2 text-sm bg-white border border-gray-300 rounded-md font-mono text-gray-700"}),e.jsx(f,{type:"button",variant:"default",size:"sm",onClick:m,children:y?"Copied!":"Copy"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Configure this webhook URL in your WhatsApp Business API settings to receive delivery status updates and user responses."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(f,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:u,children:u?i?"Updating...":"Creating...":i?"Update Integration":"Create Integration"})]})]})},G=()=>{const g=N(),{id:a}=T(),n=!!a,{getIntegrationById:b,selectedIntegration:c,isLoading:v}=k(),[u,i]=x.useState(null);if(x.useEffect(()=>{n&&a&&b(a)},[a]),x.useEffect(()=>{n&&c&&i(c.type)},[c,n]),n&&!c&&v)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(P,{})});if(n&&!c)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Integration not found"})});const l=()=>{switch(u){case"email":return e.jsx(q,{onCancel:()=>g("/integrations"),integration:n?c:void 0});case"gupshup":return e.jsx(U,{onCancel:()=>g("/integrations"),integration:n?c:void 0});case"whatsapp":return e.jsx(F,{onCancel:()=>g("/integrations"),integration:n?c:void 0});case"sms":return e.jsx(M,{onCancel:()=>g("/integrations"),integration:n?c:void 0});default:return null}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:n?"Edit Integration":"Add Integration"}),e.jsx("p",{className:"text-gray-600 mt-1",children:n?c?.name:"Connect a new marketing channel to OmniBlast"})]}),!u&&!n?e.jsx(W,{onSelect:i}):e.jsxs("div",{className:"space-y-6",children:[!n&&e.jsx("button",{onClick:()=>i(null),className:"text-sm text-blue-600 hover:text-blue-700",children:"← Back to channel selection"}),l()]})]})};export{G as IntegrationForm,G as default};
//# sourceMappingURL=IntegrationForm-BI9wOYtT.js.map
