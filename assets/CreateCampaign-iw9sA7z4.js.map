{"version":3,"file":"CreateCampaign-iw9sA7z4.js","sources":["../../../src/components/media/MediaSelectorModal.tsx","../../../src/components/CSVUploader.tsx","../../../src/components/CSVValidationTable.tsx","../../../src/pages/campaigns/CreateCampaign.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport type { MediaFile } from '../../../types/media';\r\nimport { Button, Modal } from '../index';\r\nimport { MediaGrid } from './MediaGrid';\r\n\r\ninterface MediaSelectorModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onSelect: (file: MediaFile) => void;\r\n    fileType?: 'image' | 'video' | 'document';\r\n}\r\n\r\nexport const MediaSelectorModal: React.FC<MediaSelectorModalProps> = ({ isOpen, onClose, onSelect, fileType }) => {\r\n    const [selectedFile, setSelectedFile] = useState<MediaFile | null>(null);\r\n\r\n    const handleFileSelect = (file: MediaFile) => {\r\n        setSelectedFile(file);\r\n    };\r\n\r\n    const handleConfirm = () => {\r\n        if (selectedFile) {\r\n            onSelect(selectedFile);\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Modal isOpen={isOpen} onClose={onClose} title=\"Select Media\" size=\"lg\">\r\n            <div className=\"space-y-4\">\r\n                <div className=\"max-h-96 overflow-y-auto\">\r\n                    <MediaGrid selectionMode showViewToggle showSearch fileType={fileType} onFileSelect={handleFileSelect} />\r\n                </div>\r\n\r\n                <div className=\"flex justify-end gap-3 pt-4 border-t\">\r\n                    <Button variant=\"default\" onClick={onClose}>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={handleConfirm} disabled={!selectedFile}>\r\n                        Select\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n","import React, { useRef } from 'react';\r\nimport { Button } from './index';\r\n\r\ninterface CSVUploaderProps {\r\n    onFileSelect: (content: string, fileName: string) => void;\r\n    disabled?: boolean;\r\n}\r\n\r\nexport const CSVUploader: React.FC<CSVUploaderProps> = ({ onFileSelect, disabled }) => {\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n\r\n        if (!file.name.endsWith('.csv')) {\r\n            alert('Please select a CSV file');\r\n            return;\r\n        }\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = (event) => {\r\n            const content = event.target?.result as string;\r\n            onFileSelect(content, file.name);\r\n        };\r\n        reader.readAsText(file);\r\n        e.target.value = '';\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Button variant=\"default\" onClick={() => fileInputRef.current?.click()} disabled={disabled}>\r\n                <span className=\"mr-2\">⬆</span>\r\n                Upload CSV\r\n            </Button>\r\n            <input\r\n                ref={fileInputRef}\r\n                type=\"file\"\r\n                accept=\".csv\"\r\n                className=\"hidden\"\r\n                onChange={handleFileChange}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n","import React, { useMemo, useState } from 'react';\r\nimport classNames from 'classnames';\r\nimport { Button } from './index';\r\nimport type { CSVValidationResult } from '../../types/csv-validation';\r\n\r\ninterface CSVValidationTableProps {\r\n    validation: CSVValidationResult;\r\n}\r\n\r\nconst pageSize = 50;\r\n\r\nexport const CSVValidationTable: React.FC<CSVValidationTableProps> = ({ validation }) => {\r\n    const [currentPage, setCurrentPage] = useState(1);\r\n    const [showOnlyErrors, setShowOnlyErrors] = useState(false);\r\n\r\n    const getRowErrors = (rowIndex: number) => {\r\n        return validation.errors.filter((e) => e.rowIndex === rowIndex);\r\n    };\r\n\r\n    const filteredRows = useMemo(() => {\r\n        if (!showOnlyErrors) {\r\n            return validation.rows;\r\n        }\r\n        return validation.rows.filter((row) => {\r\n            const rowErrors = getRowErrors(row.rowIndex);\r\n            return rowErrors.some((e) => e.severity === 'error');\r\n        });\r\n    }, [validation.rows, showOnlyErrors]);\r\n\r\n    const totalPages = Math.ceil(filteredRows.length / pageSize);\r\n    const startIndex = (currentPage - 1) * pageSize;\r\n    const endIndex = startIndex + pageSize;\r\n    const currentRows = filteredRows.slice(startIndex, endIndex);\r\n\r\n    const handlePrevPage = () => {\r\n        setCurrentPage((prev) => Math.max(1, prev - 1));\r\n    };\r\n\r\n    const handleNextPage = () => {\r\n        setCurrentPage((prev) => Math.min(totalPages, prev + 1));\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            <div className=\"flex items-center gap-6 p-4 bg-gray-50 rounded-lg\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <span className=\"w-5 h-5 text-green-600\">✓</span>\r\n                    <span className=\"text-sm font-medium\">{validation.validRows} Valid</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <span className=\"w-5 h-5 text-red-600\">✗</span>\r\n                    <span className=\"text-sm font-medium\">{validation.invalidRows} Invalid</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <span className=\"w-5 h-5 text-yellow-600\">⚠</span>\r\n                    <span className=\"text-sm font-medium\">{validation.warnings} Warnings</span>\r\n                </div>\r\n                <div className=\"ml-auto\">\r\n                    <label className=\"flex items-center gap-2 text-sm\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={showOnlyErrors}\r\n                            onChange={(e) => {\r\n                                setShowOnlyErrors(e.target.checked);\r\n                                setCurrentPage(1);\r\n                            }}\r\n                            className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                        />\r\n                        Show only errors\r\n                    </label>\r\n                </div>\r\n            </div>\r\n\r\n            {validation.errors.length > 0 && (\r\n                <>\r\n                    <div className=\"border border-gray-200 rounded-lg overflow-hidden\">\r\n                        <div className=\"max-h-96 overflow-y-auto\">\r\n                            <table className=\"min-w-full divide-y divide-gray-200\">\r\n                                <thead className=\"bg-gray-50 sticky top-0\">\r\n                                    <tr>\r\n                                        <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500\">Row</th>\r\n                                        <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500\">Mobile</th>\r\n                                        <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500\">Name</th>\r\n                                        <th className=\"px-4 py-2 text-left text-xs font-medium text-gray-500\">Issues</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                                    {currentRows.map((row, idx) => {\r\n                                        const rowErrors = getRowErrors(row.rowIndex);\r\n                                        const hasError = rowErrors.some((e) => e.severity === 'error');\r\n                                        const hasWarning = rowErrors.some((e) => e.severity === 'warning');\r\n\r\n                                        return (\r\n                                            <tr\r\n                                                key={idx}\r\n                                                className={classNames({\r\n                                                    'bg-red-50': hasError,\r\n                                                    'bg-yellow-50': !hasError && hasWarning,\r\n                                                })}\r\n                                            >\r\n                                                <td className=\"px-4 py-2 text-sm\">{row.rowIndex}</td>\r\n                                                <td className=\"px-4 py-2 text-sm\">{row.mobile}</td>\r\n                                                <td className=\"px-4 py-2 text-sm\">\r\n                                                    {row.name || <span className=\"text-gray-400 italic\">-</span>}\r\n                                                    {!row.name && (\r\n                                                        <span className=\"inline-block w-4 h-4 ml-1 text-red-600\">!</span>\r\n                                                    )}\r\n                                                </td>\r\n                                                <td className=\"px-4 py-2 text-sm\">\r\n                                                    {rowErrors.map((err, i) => (\r\n                                                        <div\r\n                                                            key={i}\r\n                                                            className={classNames('text-xs', {\r\n                                                                'text-red-600': err.severity === 'error',\r\n                                                                'text-yellow-600': err.severity === 'warning',\r\n                                                            })}\r\n                                                        >\r\n                                                            {err.field}: {err.message}\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </td>\r\n                                            </tr>\r\n                                        );\r\n                                    })}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {totalPages > 1 && (\r\n                        <div className=\"flex items-center justify-between px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg\">\r\n                            <div className=\"text-sm text-gray-700\">\r\n                                Showing {startIndex + 1} to {Math.min(endIndex, filteredRows.length)} of {filteredRows.length} rows\r\n                            </div>\r\n                            <div className=\"flex gap-2\">\r\n                                <Button size=\"sm\" variant=\"default\" onClick={handlePrevPage} disabled={currentPage === 1}>\r\n                                    Previous\r\n                                </Button>\r\n                                <div className=\"flex items-center px-3 text-sm text-gray-700\">\r\n                                    Page {currentPage} of {totalPages}\r\n                                </div>\r\n                                <Button size=\"sm\" variant=\"default\" onClick={handleNextPage} disabled={currentPage === totalPages}>\r\n                                    Next\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","import { Button, Dropdown, TextInput } from 'ether-ui';\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport type { CSVValidationResult } from '../../../types/csv-validation';\r\nimport type { MediaFile } from '../../../types/media';\r\nimport { CSVUploader } from '../../components/CSVUploader';\r\nimport { CSVValidationTable } from '../../components/CSVValidationTable';\r\nimport { MediaSelectorModal } from '../../components/media';\r\nimport { TemplateDetails } from '../templates/TemplateDetails';\r\nimport { getCurrentAuthToken, useAuthStore } from '../../services/auth';\r\nimport { useCampaignStore } from '../../services/campaign';\r\nimport { useIntegrationStore } from '../../services/integration';\r\nimport { useTemplateStore } from '../../services/template';\r\n\r\nconst formatCredits = (num: number) => {\r\n    if (num >= 1000000) return `${(num / 1000000).toFixed(1)}M`;\r\n    if (num >= 1000) return `${(num / 1000).toFixed(1)}K`;\r\n    return num.toLocaleString();\r\n};\r\n\r\nexport const CreateCampaign: React.FC = () => {\r\n    const navigate = useNavigate();\r\n    const [searchParams] = useSearchParams();\r\n    const { createCampaign, isLoading, error, clearError } = useCampaignStore();\r\n    const { loadTemplates, templates } = useTemplateStore();\r\n    const { loadIntegrations, integrations } = useIntegrationStore();\r\n    const { user } = useAuthStore();\r\n\r\n    const [formData, setFormData] = useState({\r\n        name: '',\r\n        templateId: searchParams.get('templateId') || '',\r\n        integrationId: '',\r\n        scheduledAt: undefined as Date | undefined,\r\n    });\r\n\r\n    const [scheduleType, setScheduleType] = useState<'now' | 'later'>('now');\r\n    const [scheduledDate, setScheduledDate] = useState('');\r\n    const [scheduledTime, setScheduledTime] = useState('');\r\n\r\n    const [csvValidation, setCSVValidation] = useState<CSVValidationResult | null>(null);\r\n    const [selectedMedia, setSelectedMedia] = useState<MediaFile | null>(null);\r\n    const [showMediaSelector, setShowMediaSelector] = useState(false);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            clearError();\r\n        };\r\n    }, [clearError]);\r\n\r\n    const selectedTemplate = useMemo(\r\n        () => templates.find((t) => t._id === formData.templateId || t.externalId === formData.templateId),\r\n        [formData.templateId, templates]\r\n    );\r\n\r\n    useEffect(() => {\r\n        loadTemplates({ status: 'approved' });\r\n        loadIntegrations();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (selectedTemplate?.integrationId && formData.integrationId !== selectedTemplate.integrationId) {\r\n            setFormData((s) => ({ ...s, integrationId: selectedTemplate.integrationId }));\r\n        }\r\n    }, [selectedTemplate, integrations]);\r\n\r\n    const requiresMedia = useMemo(() => {\r\n        if (!selectedTemplate) return false;\r\n        const templateType = (selectedTemplate as any).templateType;\r\n        return templateType && ['IMAGE', 'VIDEO', 'DOCUMENT'].includes(templateType);\r\n    }, [selectedTemplate]);\r\n\r\n    const recipientCount = csvValidation?.rows?.length || 0;\r\n    const availableCredits = user?.credits?.availableCredits || 0;\r\n    const hasInsufficientCredits = recipientCount > 0 && recipientCount > availableCredits;\r\n\r\n    const validationErrors = useMemo(() => {\r\n        const errors: string[] = [];\r\n        if (!formData.name) errors.push('Campaign name is required');\r\n        if (!formData.templateId) errors.push('Template is required');\r\n        if (!formData.integrationId) errors.push('Integration is required');\r\n        if (!csvValidation?.isValid) errors.push('Valid CSV data is required');\r\n        if (!csvValidation?.rows?.length) errors.push('At least one recipient is required');\r\n        if (requiresMedia && !selectedMedia) {\r\n            const templateType = (selectedTemplate as any).templateType;\r\n            errors.push(`Media file (${templateType?.toLowerCase()}) is required for this template type`);\r\n        }\r\n        if (hasInsufficientCredits) {\r\n            errors.push(`Insufficient credits. Required: ${recipientCount}, Available: ${availableCredits}`);\r\n        }\r\n        return errors;\r\n    }, [formData, csvValidation, requiresMedia, selectedMedia, selectedTemplate, hasInsufficientCredits, recipientCount, availableCredits]);\r\n\r\n    const templateOptions = useMemo(\r\n        () =>\r\n            templates\r\n                .filter((t) => t.status === 'approved')\r\n                .map((t) => ({\r\n                    label: `${t.displayName} (${t.type})`,\r\n                    value: t._id || t.externalId,\r\n                    integrationId: t.integrationId,\r\n                })),\r\n        [templates]\r\n    );\r\n\r\n    const integrationOptions = useMemo(\r\n        () => integrations.filter((int) => int.isActive).map((int) => ({ label: int.name, value: int.id })),\r\n        [integrations]\r\n    );\r\n\r\n    const handleCSVUpload = async (content: string, _fileName: string) => {\r\n        try {\r\n            const parameterCount = selectedTemplate?.parameterCount ?? 0;\r\n\r\n            const response = await fetch('/api/csv-campaigns/validate', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    Authorization: `Bearer ${getCurrentAuthToken()}`,\r\n                },\r\n                body: JSON.stringify({\r\n                    csvContent: content,\r\n                    parameterCount,\r\n                }),\r\n            });\r\n\r\n            const validation = await response.json();\r\n            console.log('CSV Validation Result:', validation);\r\n            setCSVValidation(validation);\r\n        } catch (error) {\r\n            console.error('CSV validation error:', error);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        clearError();\r\n\r\n        const data: any = {\r\n            ...formData,\r\n            scheduledAt:\r\n                scheduleType === 'later' && scheduledDate && scheduledTime ? new Date(`${scheduledDate}T${scheduledTime}`) : undefined,\r\n        };\r\n\r\n        if (csvValidation?.isValid && csvValidation.rows.length > 0) {\r\n            data.csvData = csvValidation.rows.map((row) => ({\r\n                mobile: row.mobile,\r\n                name: row.name,\r\n                email: row.email,\r\n                ...Object.keys(row)\r\n                    .filter((k) => k.startsWith('param'))\r\n                    .reduce((acc, key) => ({ ...acc, [key]: row[key] }), {}),\r\n            }));\r\n        }\r\n\r\n        if (selectedMedia) {\r\n            data.mediaFileId = selectedMedia.id;\r\n        }\r\n\r\n        try {\r\n            await createCampaign(data);\r\n            navigate('/campaigns');\r\n        } catch (error) {\r\n            console.error('Failed to create campaign:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"max-w-4xl mx-auto space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-gray-900\">Create Campaign</h2>\r\n                    <p className=\"text-gray-600 mt-1\">Launch a new marketing campaign</p>\r\n                </div>\r\n                <Button variant=\"default\" onClick={() => navigate('/campaigns')}>\r\n                    Cancel\r\n                </Button>\r\n            </div>\r\n\r\n            <form onSubmit={handleSubmit} className=\"bg-white rounded-lg border border-gray-200 p-6 space-y-6\">\r\n                {user?.credits && (\r\n                    <div className=\"flex items-center justify-between bg-linear-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                                <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <div>\r\n                                <p className=\"text-sm font-medium text-blue-900\">Available Credits</p>\r\n                                <p className=\"text-2xl font-bold text-blue-700\">{formatCredits(user.credits.availableCredits)}</p>\r\n                            </div>\r\n                        </div>\r\n                        {recipientCount > 0 && (\r\n                            <div className=\"text-right\">\r\n                                <p className=\"text-sm text-gray-600\">Recipients: <span className=\"font-medium\">{formatCredits(recipientCount)}</span></p>\r\n                                <p className={`text-sm font-medium ${hasInsufficientCredits ? 'text-red-600' : 'text-green-600'}`}>\r\n                                    {hasInsufficientCredits ? 'Insufficient credits' : 'Credits available'}\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                <div>\r\n                    <h3 className=\"font-semibold text-gray-900 mb-4\">Campaign Details</h3>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Campaign Name *</label>\r\n                            <TextInput\r\n                                value={formData.name}\r\n                                onChange={(e) => setFormData({ ...formData, name: e.value })}\r\n                                placeholder=\"e.g., Summer Sale 2026\"\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Template *</label>\r\n                            <Dropdown\r\n                                options={templateOptions}\r\n                                value={formData.templateId}\r\n                                onChange={(e) => {\r\n                                    const template = templates.find((t) => t._id === e.value);\r\n                                    setFormData({\r\n                                        ...formData,\r\n                                        templateId: e.value,\r\n                                        integrationId: template?.integrationId || '',\r\n                                    });\r\n                                }}\r\n                                placeholder=\"Select template\"\r\n                            />\r\n                            {selectedTemplate && (\r\n                                <div className=\"mt-4\">\r\n                                    <TemplateDetails template={selectedTemplate} variant=\"horizontal\" />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-2\">Integration *</label>\r\n                            <Dropdown\r\n                                options={integrationOptions}\r\n                                value={formData.integrationId}\r\n                                onChange={(e) => setFormData({ ...formData, integrationId: e.value })}\r\n                                placeholder=\"Select integration\"\r\n                                disabled={!!formData.templateId}\r\n                            />\r\n                            {formData.templateId && <p className=\"text-xs text-gray-500 mt-1\">Auto-selected based on template</p>}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {formData.templateId && (\r\n                    <>\r\n                        <div>\r\n                            <h3 className=\"font-semibold text-gray-900 mb-4\">Bulk Recipients (CSV)</h3>\r\n                            <div className=\"space-y-4\">\r\n                                {selectedTemplate && selectedTemplate.parameterCount !== undefined && (\r\n                                    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n                                        <div className=\"flex items-start gap-3\">\r\n                                            <div className=\"shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                                                <span className=\"text-blue-600 font-semibold text-sm\">\r\n                                                    {selectedTemplate.parameterCount}\r\n                                                </span>\r\n                                            </div>\r\n                                            <div className=\"flex-1\">\r\n                                                <p className=\"text-sm font-medium text-blue-900\">\r\n                                                    {selectedTemplate.parameterCount === 0\r\n                                                        ? 'No template parameters required'\r\n                                                        : `Template requires ${selectedTemplate.parameterCount} ${\r\n                                                              selectedTemplate.parameterCount === 1 ? 'parameter' : 'parameters'\r\n                                                          }`}\r\n                                                </p>\r\n                                                {selectedTemplate.parameterCount > 0 && (\r\n                                                    <p className=\"text-xs text-blue-700 mt-1\">\r\n                                                        Your CSV must include columns: <span className=\"font-mono font-medium\">mobile</span>\r\n                                                        {Array.from({ length: selectedTemplate.parameterCount }, (_, i) => (\r\n                                                            <span key={i}>\r\n                                                                , <span className=\"font-mono font-medium\">param{i + 1}</span>\r\n                                                            </span>\r\n                                                        ))}\r\n                                                        . Optional: <span className=\"font-mono font-medium\">name</span>,{' '}\r\n                                                        <span className=\"font-mono font-medium\">email</span>\r\n                                                    </p>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {csvValidation && !csvValidation.isValid && csvValidation.errors.some((e) => e.severity === 'error') && (\r\n                                    <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n                                        <div className=\"flex items-start gap-3\">\r\n                                            <div className=\"shrink-0 w-8 h-8 bg-red-100 rounded-full flex items-center justify-center\">\r\n                                                <span className=\"text-red-600 font-semibold text-xl\">!</span>\r\n                                            </div>\r\n                                            <div className=\"flex-1\">\r\n                                                <p className=\"text-sm font-medium text-red-900 mb-2\">CSV Validation Failed</p>\r\n                                                <ul className=\"text-xs text-red-700 space-y-1\">\r\n                                                    {csvValidation.errors\r\n                                                        .filter((e) => e.severity === 'error')\r\n                                                        .map((error, idx) => (\r\n                                                            <li key={idx}>\r\n                                                                {error.rowIndex === 0 ? (\r\n                                                                    <span className=\"font-medium\">Header Error: {error.message}</span>\r\n                                                                ) : (\r\n                                                                    <span>\r\n                                                                        Row {error.rowIndex} - {error.field}: {error.message}\r\n                                                                    </span>\r\n                                                                )}\r\n                                                            </li>\r\n                                                        ))}\r\n                                                </ul>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                <CSVUploader onFileSelect={handleCSVUpload} disabled={!formData.templateId} />\r\n                                {csvValidation && <CSVValidationTable validation={csvValidation} />}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {selectedTemplate &&\r\n                            (selectedTemplate as any).templateType &&\r\n                            ['IMAGE', 'VIDEO', 'DOCUMENT'].includes((selectedTemplate as any).templateType) && (\r\n                                <div>\r\n                                    <h3 className=\"font-semibold text-gray-900 mb-4\">Media Selection</h3>\r\n                                    {!selectedMedia ? (\r\n                                        <Button onClick={() => setShowMediaSelector(true)} variant=\"default\">\r\n                                            Select Media\r\n                                        </Button>\r\n                                    ) : (\r\n                                        <div className=\"border border-gray-200 rounded-lg p-4 space-y-3\">\r\n                                            <div className=\"flex items-start gap-4\">\r\n                                                {selectedMedia.previewType === 'image' ? (\r\n                                                    <img\r\n                                                        src={`/api/files/${selectedMedia.id}/download`}\r\n                                                        alt={selectedMedia.originalName}\r\n                                                        className=\"w-24 h-24 object-cover rounded border border-gray-200\"\r\n                                                    />\r\n                                                ) : (\r\n                                                    <div className=\"w-24 h-24 bg-gray-100 rounded border border-gray-200 flex items-center justify-center\">\r\n                                                        <span className=\"text-gray-400 text-sm\">{selectedMedia.extension}</span>\r\n                                                    </div>\r\n                                                )}\r\n                                                <div className=\"flex-1\">\r\n                                                    <p className=\"font-medium text-gray-900\">{selectedMedia.originalName}</p>\r\n                                                    <p className=\"text-sm text-gray-500 mt-1\">\r\n                                                        {(selectedMedia.size / 1024).toFixed(2)} KB • {selectedMedia.previewType}\r\n                                                    </p>\r\n                                                    <div className=\"flex gap-2 mt-3\">\r\n                                                        <Button size=\"sm\" variant=\"default\" onClick={() => setShowMediaSelector(true)}>\r\n                                                            Change\r\n                                                        </Button>\r\n                                                        <Button size=\"sm\" variant=\"default\" onClick={() => setSelectedMedia(null)}>\r\n                                                            Remove\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                    </>\r\n                )}\r\n\r\n                <div>\r\n                    <h3 className=\"font-semibold text-gray-900 mb-4\">Schedule</h3>\r\n\r\n                    <div className=\"space-y-3\">\r\n                        <label className=\"flex items-center\">\r\n                            <input\r\n                                type=\"radio\"\r\n                                name=\"schedule\"\r\n                                value=\"now\"\r\n                                checked={scheduleType === 'now'}\r\n                                onChange={(e) => setScheduleType(e.target.value as any)}\r\n                                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n                            />\r\n                            <span className=\"ml-2 text-sm text-gray-900\">Send immediately</span>\r\n                        </label>\r\n                        <label className=\"flex items-center\">\r\n                            <input\r\n                                type=\"radio\"\r\n                                name=\"schedule\"\r\n                                value=\"later\"\r\n                                checked={scheduleType === 'later'}\r\n                                onChange={(e) => setScheduleType(e.target.value as any)}\r\n                                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n                            />\r\n                            <span className=\"ml-2 text-sm text-gray-900\">Schedule for later</span>\r\n                        </label>\r\n\r\n                        {scheduleType === 'later' && (\r\n                            <div className=\"ml-6 grid grid-cols-2 gap-3\">\r\n                                <div>\r\n                                    <label className=\"block text-xs font-medium text-gray-600 mb-1\">Date</label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={scheduledDate}\r\n                                        onChange={(e) => setScheduledDate(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-xs font-medium text-gray-600 mb-1\">Time</label>\r\n                                    <input\r\n                                        type=\"time\"\r\n                                        value={scheduledTime}\r\n                                        onChange={(e) => setScheduledTime(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-3\">\r\n                    {error && (\r\n                        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n                            <div className=\"flex items-start gap-3\">\r\n                                <div className=\"shrink-0 w-6 h-6 bg-red-100 rounded-full flex items-center justify-center\">\r\n                                    <span className=\"text-red-600 font-semibold text-sm\">!</span>\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                    <p className=\"text-sm font-medium text-red-900 mb-1\">Error</p>\r\n                                    <p className=\"text-xs text-red-700\">{error}</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {validationErrors.length > 0 && (\r\n                        <div className=\"bg-orange-50 border border-orange-200 rounded-lg p-4\">\r\n                            <div className=\"flex items-start gap-3\">\r\n                                <div className=\"shrink-0 w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center\">\r\n                                    <span className=\"text-orange-600 font-semibold text-sm\">!</span>\r\n                                </div>\r\n                                <div className=\"flex-1\">\r\n                                    <p className=\"text-sm font-medium text-orange-900 mb-2\">Please complete the following:</p>\r\n                                    <ul className=\"text-xs text-orange-700 space-y-1 list-disc list-inside\">\r\n                                        {validationErrors.map((error, idx) => (\r\n                                            <li key={idx}>{error}</li>\r\n                                        ))}\r\n                                    </ul>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"flex justify-end space-x-3 pt-4 border-t\">\r\n                        <Button type=\"button\" variant=\"default\" onClick={() => navigate('/campaigns')}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button type=\"submit\" disabled={isLoading || validationErrors.length > 0}>\r\n                            {isLoading ? 'Creating...' : 'Create Campaign'}\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n\r\n            <MediaSelectorModal\r\n                isOpen={showMediaSelector}\r\n                onClose={() => setShowMediaSelector(false)}\r\n                onSelect={(file) => setSelectedMedia(file)}\r\n                fileType={(selectedTemplate as any)?.templateType?.toLowerCase()}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CreateCampaign;\r\n"],"names":["MediaSelectorModal","isOpen","onClose","onSelect","fileType","selectedFile","setSelectedFile","useState","handleFileSelect","file","handleConfirm","jsx","Modal","jsxs","MediaGrid","Button","CSVUploader","onFileSelect","disabled","fileInputRef","useRef","handleFileChange","e","reader","event","content","pageSize","CSVValidationTable","validation","currentPage","setCurrentPage","showOnlyErrors","setShowOnlyErrors","getRowErrors","rowIndex","filteredRows","useMemo","row","totalPages","startIndex","endIndex","currentRows","handlePrevPage","prev","handleNextPage","Fragment","idx","rowErrors","hasError","hasWarning","classNames","err","i","formatCredits","num","CreateCampaign","navigate","useNavigate","searchParams","useSearchParams","createCampaign","isLoading","error","clearError","useCampaignStore","loadTemplates","templates","useTemplateStore","loadIntegrations","integrations","useIntegrationStore","user","useAuthStore","formData","setFormData","scheduleType","setScheduleType","scheduledDate","setScheduledDate","scheduledTime","setScheduledTime","csvValidation","setCSVValidation","selectedMedia","setSelectedMedia","showMediaSelector","setShowMediaSelector","useEffect","selectedTemplate","t","requiresMedia","templateType","recipientCount","availableCredits","hasInsufficientCredits","validationErrors","errors","templateOptions","integrationOptions","int","handleCSVUpload","_fileName","parameterCount","getCurrentAuthToken","handleSubmit","data","k","acc","key","TextInput","Dropdown","template","TemplateDetails","_"],"mappings":"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"}