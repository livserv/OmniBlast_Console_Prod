import{f as w,r as n,j as e,l as c,P as k,D as T,B as C,u as W,e as U,v as D}from"../index.CMmRcy_I.js";import{L as F}from"./LoadingSpinner-8uHsdOWH.js";import{u as E}from"./integration-ZaUHA7EP.js";const L=[{label:"SMTP",value:"smtp"},{label:"SendGrid",value:"sendgrid"},{label:"Mailgun",value:"mailgun"},{label:"AWS SES",value:"aws-ses"}],$=({onCancel:g,integration:s})=>{const r=w(),{createIntegration:f,updateIntegration:p,isLoading:N}=E(),x=!!s,[u,l]=n.useState(""),[m,I]=n.useState(""),[v,y]=n.useState(""),[j,b]=n.useState(""),[a,o]=n.useState({provider:"smtp",fromEmail:"",fromName:""}),[i,d]=n.useState("");n.useEffect(()=>{s&&(l(s.name||""),I(s.appId||""),y(s.appName||""),b(s.secret||""),o(s.config))},[s]);const S=async t=>{t.preventDefault(),d("");try{x&&s?.id?await p(s.id,{name:u,appId:m,appName:v,secret:j,config:a}):await f({type:"email",name:u,appId:m,appName:v,secret:j,config:a}),r("/integrations")}catch(A){d(A?.message||`Failed to ${x?"update":"create"} integration`)}};return e.jsxs("form",{onSubmit:S,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your email service provider"})]}),i&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-600 text-sm",children:i})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(c,{value:u,onChange:t=>l(t.value),placeholder:"e.g., Production Email Server",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App ID"}),e.jsx(c,{value:m,onChange:t=>I(t.value),placeholder:"Enter your App ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App Name"}),e.jsx(c,{value:v,onChange:t=>y(t.value),placeholder:"Enter your App Name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Secret"}),e.jsx(k,{value:j,onChange:t=>b(t.value),placeholder:"Enter your API secret",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider"}),e.jsx(T,{options:L,value:a.provider,onChange:t=>o({...a,provider:t})})]}),a.provider==="smtp"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMTP Host"}),e.jsx(c,{value:a.host||"",onChange:t=>o({...a,host:t.value}),placeholder:"smtp.example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMTP Port"}),e.jsx(c,{type:"number",value:a.port?.toString()||"",onChange:t=>o({...a,port:parseInt(t.value)}),placeholder:"587",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx(c,{value:a.username||"",onChange:t=>o({...a,username:t.value}),placeholder:"your-username",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx(k,{value:a.password||"",onChange:t=>o({...a,password:t.value}),placeholder:"your-password",required:!0})]})]}),(a.provider==="sendgrid"||a.provider==="mailgun"||a.provider==="aws-ses")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx(k,{value:a.apiKey||"",onChange:t=>o({...a,apiKey:t.value}),placeholder:"Enter your API key",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Email"}),e.jsx(c,{type:"email",value:a.fromEmail,onChange:t=>o({...a,fromEmail:t.value}),placeholder:"noreply@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Name"}),e.jsx(c,{value:a.fromName,onChange:t=>o({...a,fromName:t.value}),placeholder:"Your Company Name",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(C,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:N,children:N?x?"Updating...":"Creating...":x?"Update Integration":"Create Integration"})]})]})},G=({onCancel:g,integration:s})=>{const r=w(),{user:f}=W(),{createIntegration:p,updateIntegration:N,isLoading:x}=E(),u=!!s,[l,m]=n.useState({type:"gupshup"}),[I,v]=n.useState(!1),[y,j]=n.useState("");n.useEffect(()=>{s&&m(s)},[s]);const b=l.id&&f?.organizationId?`${U.apiExternalBasePath}/api/webhooks/gupshup/${f.organizationId}/${l.id}/callback`:"",a=async()=>{b&&(await navigator.clipboard.writeText(b),v(!0),setTimeout(()=>v(!1),2e3))},o=async i=>{i.preventDefault(),j("");try{u&&l.id?await N(l.id,{name:l.name,appId:l.appId,appName:l.appName,secret:l.secret,config:l.config}):await p(l),r("/integrations")}catch(d){j(d?.message||`Failed to ${u?"update":"create"} integration`)}};return e.jsxs("form",{onSubmit:o,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gupshup Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your Gupshup WhatsApp Business API connection"})]}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-600 text-sm",children:y})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(c,{value:l.name,onChange:i=>m(d=>({...d,name:i.value})),placeholder:"e.g., My Gupshup Account",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App Id"}),e.jsx(c,{value:l.appId,onChange:i=>m(d=>({...d,appId:i.value})),placeholder:"e.g., 3h0bg315-4n14-9d57-1y64-h594gys76732",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App Name"}),e.jsx(c,{value:l.appName,onChange:i=>m(d=>({...d,appName:i.value})),placeholder:"Your Gupshup app name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key / Secret"}),e.jsx(k,{value:l.secret,onChange:i=>m(d=>({...d,secret:i.value})),placeholder:"Enter your Gupshup API key",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Source Phone Number"}),e.jsx(c,{value:l.config?.phoneNumber,onChange:i=>m(d=>({...d,config:{...d.config,phoneNumber:i.value}})),placeholder:"e.g., 919876543210",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Your Gupshup registered phone number (with country code, without + sign)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Endpoint"}),e.jsx(c,{value:l.config?.apiVersion,onChange:i=>m(d=>({...d,config:{...d.config,apiVersion:i.value}})),placeholder:"v2 or v3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Callback URL (Optional)"}),e.jsx(c,{value:l.config?.callbackUrl||"",onChange:i=>m(d=>({...d,config:{...d.config,callbackUrl:i.value}})),placeholder:"https://your-server.com/webhook"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"URL to handle and respond to user queries"})]}),b&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Webhook URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:b,className:"flex-1 px-3 py-2 text-sm bg-white border border-gray-300 rounded-md font-mono text-gray-700"}),e.jsx(C,{type:"button",variant:"default",size:"sm",onClick:a,children:I?"Copied!":"Copy"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Configure this webhook URL in your Gupshup dashboard to receive delivery status updates and user responses."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," You can find your API key in your Gupshup dashboard under Settings → API Keys."]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(C,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:x,children:x?u?"Updating...":"Creating...":u?"Update Integration":"Create Integration"})]})]})},R=({onSelect:g})=>{const s=[{type:"email",title:"Email",description:"Connect SMTP, SendGrid, Mailgun, or AWS SES",color:"blue"},{type:"gupshup",title:"Gupshup",description:"WhatsApp Business API via Gupshup",color:"green"},{type:"whatsapp",title:"WhatsApp",description:"Direct WhatsApp Business API or Twilio",color:"green"},{type:"sms",title:"SMS",description:"Twilio, MessageBird, or AWS SNS",color:"purple"},{type:"telegram",title:"Telegram",description:"Telegram Bot API",color:"cyan"}];return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Channel Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(r=>e.jsxs("button",{onClick:()=>g(r.type),className:`bg-${r.color}-50 border-2 border-${r.color}-200 rounded-lg p-6 text-left hover:bg-${r.color}-100 transition-colors`,children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:r.title}),e.jsx("p",{className:"text-sm text-gray-600",children:r.description})]},r.type))})]})},K=[{label:"Twilio",value:"twilio"},{label:"MessageBird",value:"messagebird"},{label:"AWS SNS",value:"aws-sns"}],O=({onCancel:g,integration:s})=>{const r=w(),{createIntegration:f,updateIntegration:p,isLoading:N}=E(),x=!!s,[u,l]=n.useState(""),[m,I]=n.useState(""),[v,y]=n.useState(""),[j,b]=n.useState(""),[a,o]=n.useState({provider:"twilio",fromNumber:""}),[i,d]=n.useState("");n.useEffect(()=>{s&&(l(s.name||""),I(s.appId||""),y(s.appName||""),b(s.secret||""),o(s.config))},[s]);const S=async t=>{t.preventDefault(),d("");try{x&&s?.id?await p(s.id,{name:u,appId:m,appName:v,secret:j,config:a}):await f({type:"sms",name:u,appId:m,appName:v,secret:j,config:a}),r("/integrations")}catch(A){d(A?.message||`Failed to ${x?"update":"create"} integration`)}};return e.jsxs("form",{onSubmit:S,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"SMS Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your SMS service provider"})]}),i&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-600 text-sm",children:i})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(c,{value:u,onChange:t=>l(t.value),placeholder:"e.g., Twilio SMS",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App ID"}),e.jsx(c,{value:m,onChange:t=>I(t.value),placeholder:"Enter your App ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App Name"}),e.jsx(c,{value:v,onChange:t=>y(t.value),placeholder:"Enter your App Name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Secret"}),e.jsx(k,{value:j,onChange:t=>b(t.value),placeholder:"Enter your API secret",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider"}),e.jsx(T,{options:K,value:a.provider,onChange:t=>o({...a,provider:t})})]}),a.provider==="twilio"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account SID"}),e.jsx(c,{value:a.accountSid||"",onChange:t=>o({...a,accountSid:t.value}),placeholder:"Enter your Twilio Account SID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auth Token"}),e.jsx(k,{value:a.authToken||"",onChange:t=>o({...a,authToken:t.value}),placeholder:"Enter your Twilio Auth Token",required:!0})]})]}),(a.provider==="messagebird"||a.provider==="aws-sns")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),e.jsx(k,{value:a.apiKey||"",onChange:t=>o({...a,apiKey:t.value}),placeholder:"Enter your API key",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Number"}),e.jsx(c,{value:a.fromNumber,onChange:t=>o({...a,fromNumber:t.value}),placeholder:"+1234567890",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(C,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:N,children:N?x?"Updating...":"Creating...":x?"Update Integration":"Create Integration"})]})]})},z=({onCancel:g,integration:s})=>{const r=w(),{user:f}=W(),{createIntegration:p,updateIntegration:N,isLoading:x}=E(),u=!!s,[l,m]=n.useState(""),[I,v]=n.useState(""),[y,j]=n.useState(""),[b,a]=n.useState(""),[o,i]=n.useState({fromNumber:""}),[d,S]=n.useState(!1),[t,A]=n.useState("");n.useEffect(()=>{s&&(m(s.name||""),v(s.appId||""),j(s.appName||""),a(s.secret||""),i(s.config))},[s]);const q=s?.id&&f?.organizationId?`${U.apiExternalBasePath}/api/webhooks/whatsapp/${f.organizationId}/${s.id}/callback`:"",P=async()=>{q&&(await navigator.clipboard.writeText(q),S(!0),setTimeout(()=>S(!1),2e3))},M=async h=>{h.preventDefault(),A("");try{u&&s?.id?await N(s.id,{name:l,appId:I,appName:y,secret:b,config:o}):await p({type:"whatsapp",name:l,appId:I,appName:y,secret:b,config:o}),r("/integrations")}catch(B){A(B?.message||`Failed to ${u?"update":"create"} integration`)}};return e.jsxs("form",{onSubmit:M,className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"WhatsApp Integration"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure your WhatsApp Business API connection"})]}),t&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-600 text-sm",children:t})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Integration Name"}),e.jsx(c,{value:l,onChange:h=>m(h.value),placeholder:"e.g., WhatsApp Business Account",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WSBA ID"}),e.jsx(c,{value:I,onChange:h=>v(h.value),placeholder:"Enter your WhatsApp Business Account ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App Name"}),e.jsx(c,{value:y,onChange:h=>j(h.value),placeholder:"Enter your WhatsApp App Name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Token"}),e.jsx(k,{value:b,onChange:h=>a(h.value),placeholder:"Enter your access token",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number ID"}),e.jsx(c,{value:o.phoneNumberId||"",onChange:h=>i({...o,phoneNumberId:h.value}),placeholder:"Enter your phone number ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Number"}),e.jsx(c,{value:o.fromNumber,onChange:h=>i({...o,fromNumber:h.value}),placeholder:"+1234567890",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Callback URL (Optional)"}),e.jsx(c,{value:o.callbackUrl||"",onChange:h=>i({...o,callbackUrl:h.value}),placeholder:"https://your-server.com/webhook"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"URL to handle and respond to user queries"})]}),q&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Webhook URL"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:q,className:"flex-1 px-3 py-2 text-sm bg-white border border-gray-300 rounded-md font-mono text-gray-700"}),e.jsx(C,{type:"button",variant:"default",size:"sm",onClick:P,children:d?"Copied!":"Copy"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Configure this webhook URL in your WhatsApp Business API settings to receive delivery status updates and user responses."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(C,{type:"button",variant:"default",onClick:g,children:"Cancel"}),e.jsx(C,{type:"submit",disabled:x,children:x?u?"Updating...":"Creating...":u?"Update Integration":"Create Integration"})]})]})},J=()=>{const g=w(),{id:s}=D(),r=!!s,{getIntegrationById:f,selectedIntegration:p,isLoading:N}=E(),[x,u]=n.useState(null);if(n.useEffect(()=>{r&&s&&f(s)},[s]),n.useEffect(()=>{r&&p&&u(p.type)},[p,r]),r&&!p&&N)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(F,{})});if(r&&!p)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Integration not found"})});const l=()=>{switch(x){case"email":return e.jsx($,{onCancel:()=>g("/integrations"),integration:r?p:void 0});case"gupshup":return e.jsx(G,{onCancel:()=>g("/integrations"),integration:r?p:void 0});case"whatsapp":return e.jsx(z,{onCancel:()=>g("/integrations"),integration:r?p:void 0});case"sms":return e.jsx(O,{onCancel:()=>g("/integrations"),integration:r?p:void 0});default:return null}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r?"Edit Integration":"Add Integration"}),e.jsx("p",{className:"text-gray-600 mt-1",children:r?p?.name:"Connect a new marketing channel to OmniBlast"})]}),!x&&!r?e.jsx(R,{onSelect:u}):e.jsxs("div",{className:"space-y-6",children:[!r&&e.jsx("button",{onClick:()=>u(null),className:"text-sm text-blue-600 hover:text-blue-700",children:"← Back to channel selection"}),l()]})]})};export{J as IntegrationForm,J as default};
//# sourceMappingURL=IntegrationForm-DSkl7nla.js.map
