{"version":3,"file":"MediaGrid-BNp8TO_l.js","sources":["../../../src/services/media.ts","../../../src/components/ConfirmationModal.tsx","../../../src/components/FileUpload.tsx","../../../src/components/media/MediaTile.tsx","../../../src/components/media/MediaGridView.tsx","../../../src/components/media/MediaListItem.tsx","../../../src/components/media/MediaListView.tsx","../../../src/components/media/MediaGrid.tsx"],"sourcesContent":["import { create } from 'zustand';\r\nimport type { MediaFile } from '../../types/media';\r\nimport ajax from './ajax';\r\n\r\ninterface MediaStore {\r\n    files: MediaFile[];\r\n    isLoading: boolean;\r\n    loadFiles: (filters?: any) => Promise<void>;\r\n    deleteFile: (fileId: string) => Promise<void>;\r\n}\r\n\r\nexport const useMediaStore = create<MediaStore>((set) => ({\r\n    files: [],\r\n    isLoading: false,\r\n    loadFiles: async (filters) => {\r\n        set({ isLoading: true });\r\n        try {\r\n            const query = new URLSearchParams(filters || {}).toString();\r\n            const url = query ? `/api/files?${query}` : '/api/files';\r\n            const response = await ajax.get(url);\r\n            set({ files: response.files || response, isLoading: false });\r\n        } catch (error) {\r\n            console.error('Load files error:', error);\r\n            set({ isLoading: false });\r\n        }\r\n    },\r\n    deleteFile: async (fileId) => {\r\n        await ajax.delete(`/files/${fileId}`);\r\n    },\r\n}));\r\n","import React from 'react';\nimport { Modal, Button } from './index';\n\ninterface ConfirmationModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onConfirm: () => void;\n    title: string;\n    message: string;\n    confirmText?: string;\n    cancelText?: string;\n    variant?: 'danger' | 'warning' | 'info';\n}\n\nexport const ConfirmationModal: React.FC<ConfirmationModalProps> = ({\n    isOpen,\n    onClose,\n    onConfirm,\n    title,\n    message,\n    confirmText = 'Confirm',\n    cancelText = 'Cancel',\n    variant = 'danger',\n}) => {\n    const handleConfirm = () => {\n        onConfirm();\n        onClose();\n    };\n\n    return (\n        <Modal isOpen={isOpen} onClose={onClose} title={title} size=\"sm\">\n            <div className=\"space-y-4\">\n                <p className=\"text-gray-700\">{message}</p>\n                <div className=\"flex justify-end gap-3 pt-4 border-t\">\n                    <Button variant=\"default\" onClick={onClose}>\n                        {cancelText}\n                    </Button>\n                    <Button\n                        variant={variant === 'danger' ? 'primary' : 'default'}\n                        onClick={handleConfirm}\n                    >\n                        {confirmText}\n                    </Button>\n                </div>\n            </div>\n        </Modal>\n    );\n};\n","import classNames from 'classnames';\r\nimport { TimesIcon, UploadIcon } from 'ether-ui/icons';\r\nimport React, { useCallback, useRef, useState } from 'react';\r\n\r\nexport interface UploadingFile {\r\n    id: string;\r\n    file: File;\r\n    progress: number;\r\n    status: 'uploading' | 'completed' | 'error';\r\n    error?: string;\r\n}\r\n\r\ninterface FileUploadProps {\r\n    uploadUrl: string;\r\n    getAuthToken?: () => string | null;\r\n    allowedExtensions?: string[];\r\n    maxFileSize?: number;\r\n    maxFiles?: number;\r\n    onUploadComplete?: (files: any[]) => void;\r\n    onUploadStart?: (files: File[]) => void;\r\n    onUploadProgress?: (fileId: string, progress: number) => void;\r\n    onUploadError?: (fileId: string, error: string) => void;\r\n    className?: string;\r\n    children?: React.ReactNode;\r\n}\r\n\r\nconst validateFile = (file: File, maxFileSize: number, allowedExtensions?: string[]): string | null => {\r\n    if (file.size > maxFileSize) {\r\n        return `File size exceeds ${Math.round(maxFileSize / 1024 / 1024)}MB limit`;\r\n    }\r\n\r\n    if (allowedExtensions && allowedExtensions.length > 0) {\r\n        const fileExtension = file.name.split('.').pop()?.toLowerCase();\r\n        if (!fileExtension || !allowedExtensions.includes(`.${fileExtension}`)) {\r\n            return `File type not allowed. Allowed types: ${allowedExtensions.join(', ')}`;\r\n        }\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\nconst uploadFileToServer = (\r\n    file: File,\r\n    uploadUrl: string,\r\n    authToken: string | null,\r\n    onProgress: (progress: number) => void,\r\n    abortSignal: AbortSignal\r\n): Promise<any> => {\r\n    return new Promise((resolve, reject) => {\r\n        const formData = new FormData();\r\n        formData.append('files', file);\r\n\r\n        const xhr = new XMLHttpRequest();\r\n\r\n        xhr.upload.addEventListener('progress', (event) => {\r\n            if (event.lengthComputable) {\r\n                const progress = Math.round((event.loaded * 100) / event.total);\r\n                onProgress(progress);\r\n            }\r\n        });\r\n\r\n        xhr.addEventListener('load', () => {\r\n            if (xhr.status === 200) {\r\n                const response = JSON.parse(xhr.responseText);\r\n                resolve(response.files?.[0]);\r\n            } else {\r\n                try {\r\n                    const response = JSON.parse(xhr.responseText);\r\n                    reject(new Error(response.message || response.error || 'Upload failed'));\r\n                } catch {\r\n                    reject(new Error('Upload failed'));\r\n                }\r\n            }\r\n        });\r\n\r\n        xhr.addEventListener('error', () => {\r\n            reject(new Error('Network error'));\r\n        });\r\n\r\n        abortSignal.addEventListener('abort', () => {\r\n            xhr.abort();\r\n            reject(new Error('Upload cancelled'));\r\n        });\r\n\r\n        xhr.open('POST', uploadUrl);\r\n        if (authToken) {\r\n            xhr.setRequestHeader('Authorization', `Bearer ${authToken}`);\r\n        }\r\n        xhr.send(formData);\r\n    });\r\n};\r\n\r\nconst FileUpload: React.FC<FileUploadProps> = ({\r\n    uploadUrl,\r\n    getAuthToken,\r\n    allowedExtensions,\r\n    maxFileSize = 50 * 1024 * 1024,\r\n    maxFiles = 10,\r\n    onUploadComplete,\r\n    onUploadStart,\r\n    onUploadProgress,\r\n    onUploadError,\r\n    className,\r\n    children,\r\n}) => {\r\n    const [isDragOver, setIsDragOver] = useState(false);\r\n    const [uploadingFiles, setUploadingFiles] = useState<UploadingFile[]>([]);\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const abortControllersRef = useRef<Map<string, AbortController>>(new Map());\r\n\r\n    const uploadFile = async (file: File): Promise<any> => {\r\n        const fileId = `${Date.now()}-${Math.random()}`;\r\n        const abortController = new AbortController();\r\n        abortControllersRef.current.set(fileId, abortController);\r\n\r\n        const uploadingFile: UploadingFile = {\r\n            id: fileId,\r\n            file,\r\n            progress: 0,\r\n            status: 'uploading',\r\n        };\r\n\r\n        setUploadingFiles((prev) => [...prev, uploadingFile]);\r\n\r\n        try {\r\n            const authToken = getAuthToken ? getAuthToken() : null;\r\n\r\n            const result = await uploadFileToServer(\r\n                file,\r\n                uploadUrl,\r\n                authToken,\r\n                (progress) => {\r\n                    setUploadingFiles((prev) => prev.map((f) => (f.id === fileId ? { ...f, progress } : f)));\r\n                    onUploadProgress?.(fileId, progress);\r\n                },\r\n                abortController.signal\r\n            );\r\n\r\n            setUploadingFiles((prev) => prev.map((f) => (f.id === fileId ? { ...f, status: 'completed', progress: 100 } : f)));\r\n            return result;\r\n        } catch (error) {\r\n            const errorMessage = error instanceof Error ? error.message : 'Upload failed';\r\n            setUploadingFiles((prev) => prev.map((f) => (f.id === fileId ? { ...f, status: 'error', error: errorMessage } : f)));\r\n            onUploadError?.(fileId, errorMessage);\r\n            throw error;\r\n        } finally {\r\n            abortControllersRef.current.delete(fileId);\r\n        }\r\n    };\r\n\r\n    const handleFiles = useCallback(\r\n        async (files: FileList) => {\r\n            const fileArray = Array.from(files);\r\n\r\n            if (fileArray.length > maxFiles) {\r\n                alert(`Maximum ${maxFiles} files allowed`);\r\n                return;\r\n            }\r\n\r\n            const validFiles: File[] = [];\r\n            const errors: string[] = [];\r\n\r\n            fileArray.forEach((file) => {\r\n                const error = validateFile(file, maxFileSize, allowedExtensions);\r\n                if (error) {\r\n                    errors.push(`${file.name}: ${error}`);\r\n                } else {\r\n                    validFiles.push(file);\r\n                }\r\n            });\r\n\r\n            if (errors.length > 0) {\r\n                alert(`File validation errors:\\n${errors.join('\\n')}`);\r\n            }\r\n\r\n            if (validFiles.length === 0) return;\r\n\r\n            onUploadStart?.(validFiles);\r\n\r\n            const uploadPromises = validFiles.map(uploadFile);\r\n\r\n            try {\r\n                const results = await Promise.allSettled(uploadPromises);\r\n                const uploadedFiles = results\r\n                    .filter((result): result is PromiseFulfilledResult<any> => result.status === 'fulfilled')\r\n                    .map((result) => result.value);\r\n\r\n                if (uploadedFiles.length > 0) {\r\n                    onUploadComplete?.(uploadedFiles);\r\n                }\r\n\r\n                setTimeout(() => {\r\n                    setUploadingFiles((prev) => prev.filter((f) => f.status === 'uploading'));\r\n                }, 3000);\r\n            } catch (error) {\r\n                console.error('Upload error:', error);\r\n            }\r\n        },\r\n        [maxFiles, maxFileSize, allowedExtensions, onUploadStart, onUploadComplete, onUploadProgress, onUploadError, uploadFile]\r\n    );\r\n\r\n    const cancelUpload = (fileId: string) => {\r\n        const abortController = abortControllersRef.current.get(fileId);\r\n        if (abortController) {\r\n            abortController.abort();\r\n        }\r\n    };\r\n\r\n    const handleDragOver = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (!isDragOver) {\r\n            setIsDragOver(true);\r\n        }\r\n    };\r\n\r\n    const handleDragLeave = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (e.currentTarget === e.target) {\r\n            setIsDragOver(false);\r\n        }\r\n    };\r\n\r\n    const handleDrop = (e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setIsDragOver(false);\r\n\r\n        const files = e.dataTransfer.files;\r\n        if (files.length > 0) {\r\n            handleFiles(files);\r\n        }\r\n    };\r\n\r\n    const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const files = e.target.files;\r\n        if (files && files.length > 0) {\r\n            handleFiles(files);\r\n        }\r\n        e.target.value = '';\r\n    };\r\n\r\n    const openFileDialog = () => {\r\n        fileInputRef.current?.click();\r\n    };\r\n\r\n    return (\r\n        <div className={className}>\r\n            <div\r\n                className={classNames('relative border-2 border-dashed rounded-lg transition-all duration-200', {\r\n                    'border-blue-400 bg-blue-50': isDragOver,\r\n                    'border-gray-300 hover:border-gray-400': !isDragOver,\r\n                })}\r\n                onDragOver={handleDragOver}\r\n                onDragLeave={handleDragLeave}\r\n                onDrop={handleDrop}\r\n            >\r\n                {!children && (\r\n                    <div className=\"p-8 text-center\">\r\n                        <UploadIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n                        <div className=\"space-y-2\">\r\n                            <p className=\"text-lg font-medium text-gray-900\">Drop files here to upload</p>\r\n                            <p className=\"text-sm text-gray-500\">\r\n                                or{' '}\r\n                                <button\r\n                                    type=\"button\"\r\n                                    onClick={openFileDialog}\r\n                                    className=\"text-blue-600 hover:text-blue-700 font-medium underline\"\r\n                                >\r\n                                    browse from your computer\r\n                                </button>\r\n                            </p>\r\n                            {allowedExtensions && <p className=\"text-xs text-gray-400\">Allowed: {allowedExtensions.join(', ')}</p>}\r\n                            <p className=\"text-xs text-gray-400\">Max size: {Math.round(maxFileSize / 1024 / 1024)}MB per file</p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {children}\r\n\r\n                {uploadingFiles.length > 0 && (\r\n                    <div className=\"absolute inset-0 bg-white bg-opacity-90 rounded-lg flex items-center justify-center\">\r\n                        <div className=\"w-full max-w-md p-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Uploading Files...</h3>\r\n                            <div className=\"space-y-3\">\r\n                                {uploadingFiles.map((file) => (\r\n                                    <div key={file.id} className=\"relative\">\r\n                                        <div className=\"flex items-center justify-between mb-1\">\r\n                                            <span className=\"text-sm text-gray-700 truncate\">{file.file.name}</span>\r\n                                            <div className=\"flex items-center space-x-2\">\r\n                                                <span className=\"text-xs text-gray-500\">\r\n                                                    {file.status === 'uploading' && `${file.progress}%`}\r\n                                                    {file.status === 'completed' && 'Complete'}\r\n                                                    {file.status === 'error' && 'Error'}\r\n                                                </span>\r\n                                                {file.status === 'uploading' && (\r\n                                                    <button onClick={() => cancelUpload(file.id)} className=\"text-red-500 hover:text-red-700\">\r\n                                                        <TimesIcon className=\"h-4 w-4\" />\r\n                                                    </button>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                        {file.status === 'uploading' && (\r\n                                            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                                                <div\r\n                                                    className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                                                    style={{ width: `${file.progress}%` }}\r\n                                                />\r\n                                            </div>\r\n                                        )}\r\n                                        {file.status === 'error' && file.error && <p className=\"text-xs text-red-600 mt-1\">{file.error}</p>}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            <input\r\n                ref={fileInputRef}\r\n                type=\"file\"\r\n                multiple\r\n                className=\"hidden\"\r\n                onChange={handleFileInputChange}\r\n                accept={allowedExtensions?.join(',')}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default FileUpload;\r\n","import classNames from 'classnames';\nimport { DownloadIcon, TrashIcon } from 'ether-ui/icons';\nimport React from 'react';\nimport type { MediaFile } from '../../../types/media';\nimport { Button } from '../index';\n\ninterface MediaTileProps {\n    file: MediaFile;\n    index: number;\n    selectionMode: boolean;\n    isSelected: boolean;\n    onFileClick: (file: MediaFile, index: number) => void;\n    onDownload: (file: MediaFile) => void;\n    onDeleteRequest: (file: MediaFile) => void;\n    onKeyDown: (e: React.KeyboardEvent, index: number) => void;\n    setRef: (el: HTMLDivElement | null) => void;\n}\n\nexport const MediaTile: React.FC<MediaTileProps> = ({\n    file,\n    index,\n    selectionMode,\n    isSelected,\n    onFileClick,\n    onDownload,\n    onDeleteRequest,\n    onKeyDown,\n    setRef,\n}) => {\n    return (\n        <div\n            ref={setRef}\n            tabIndex={0}\n            title={file.originalName}\n            className={classNames(\n                'border rounded-lg p-4 space-y-2 cursor-pointer transition-all outline-none',\n                'focus:ring-2 focus:ring-blue-500',\n                {\n                    'border-blue-500 bg-blue-50': selectionMode && isSelected,\n                    'border-gray-200 hover:border-gray-300': !selectionMode || !isSelected,\n                    'hover:shadow-md': !selectionMode,\n                }\n            )}\n            onClick={() => onFileClick(file, index)}\n            onKeyDown={(e) => onKeyDown(e, index)}\n        >\n            {file.previewType === 'image' ? (\n                <img src={`/api/files/${file.id}/download`} alt={file.originalName} className=\"w-full h-32 object-cover rounded\" />\n            ) : (\n                <div className=\"w-full h-32 bg-gray-100 rounded flex items-center justify-center\">\n                    <span className=\"text-gray-400 text-sm\">{file.extension}</span>\n                </div>\n            )}\n            <p className=\"text-sm font-medium truncate\">{file.originalName}</p>\n            <p className=\"text-xs text-gray-500\">{(file.size / 1024).toFixed(2)} KB</p>\n\n            {!selectionMode && (\n                <div className=\"flex gap-2\" onClick={(e) => e.stopPropagation()}>\n                    <Button\n                        size=\"sm\"\n                        variant=\"primary\"\n                        layout=\"plain\"\n                        leftIcon={DownloadIcon}\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            onDownload(file);\n                        }}\n                    />\n                    <Button\n                        size=\"sm\"\n                        variant=\"danger\"\n                        layout=\"plain\"\n                        leftIcon={TrashIcon}\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            onDeleteRequest(file);\n                        }}\n                    />\n                </div>\n            )}\n        </div>\n    );\n};\n","import React from 'react';\nimport type { MediaFile } from '../../../types/media';\nimport { MediaTile } from './MediaTile';\n\ninterface MediaGridViewProps {\n    files: MediaFile[];\n    selectionMode: boolean;\n    selectedFileId: string | null;\n    onFileClick: (file: MediaFile, index: number) => void;\n    onDownload: (file: MediaFile) => void;\n    onDeleteRequest: (file: MediaFile) => void;\n    onKeyDown: (e: React.KeyboardEvent, index: number) => void;\n    setFileRef: (index: number) => (el: HTMLDivElement | null) => void;\n    containerRef: React.RefObject<HTMLDivElement | null>;\n}\n\nexport const MediaGridView: React.FC<MediaGridViewProps> = ({\n    files,\n    selectionMode,\n    selectedFileId,\n    onFileClick,\n    onDownload,\n    onDeleteRequest,\n    onKeyDown,\n    setFileRef,\n    containerRef,\n}) => {\n    return (\n        <div ref={containerRef} className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 p-1\">\n            {files.map((file, index) => (\n                <MediaTile\n                    key={file.id}\n                    file={file}\n                    index={index}\n                    selectionMode={selectionMode}\n                    isSelected={selectedFileId === file.id}\n                    onFileClick={onFileClick}\n                    onDownload={onDownload}\n                    onDeleteRequest={onDeleteRequest}\n                    onKeyDown={onKeyDown}\n                    setRef={setFileRef(index)}\n                />\n            ))}\n        </div>\n    );\n};\n","import classNames from 'classnames';\nimport { DownloadIcon, TrashIcon } from 'ether-ui/icons';\nimport React from 'react';\nimport type { MediaFile } from '../../../types/media';\nimport { Button } from '../index';\n\ninterface MediaListItemProps {\n    file: MediaFile;\n    index: number;\n    selectionMode: boolean;\n    isSelected: boolean;\n    onFileClick: (file: MediaFile, index: number) => void;\n    onDownload: (file: MediaFile) => void;\n    onDeleteRequest: (file: MediaFile) => void;\n    onKeyDown: (e: React.KeyboardEvent, index: number) => void;\n    setRef: (el: HTMLDivElement | null) => void;\n}\n\nexport const MediaListItem: React.FC<MediaListItemProps> = ({\n    file,\n    index,\n    selectionMode,\n    isSelected,\n    onFileClick,\n    onDownload,\n    onDeleteRequest,\n    onKeyDown,\n    setRef,\n}) => {\n    return (\n        <div\n            ref={setRef}\n            tabIndex={0}\n            title={file.originalName}\n            className={classNames(\n                'flex items-center justify-between p-4 border rounded-lg cursor-pointer transition-all outline-none',\n                'focus:ring-2 focus:ring-blue-500',\n                {\n                    'border-blue-500 bg-blue-50': selectionMode && isSelected,\n                    'border-gray-200 hover:border-gray-300': !selectionMode || !isSelected,\n                }\n            )}\n            onClick={() => onFileClick(file, index)}\n            onKeyDown={(e) => onKeyDown(e, index)}\n        >\n            <div className=\"flex items-center gap-4\">\n                {file.previewType === 'image' ? (\n                    <img src={`/api/files/${file.id}/download`} alt={file.originalName} className=\"w-16 h-16 object-cover rounded\" />\n                ) : (\n                    <div className=\"w-16 h-16 bg-gray-100 rounded flex items-center justify-center\">\n                        <span className=\"text-gray-400 text-xs\">{file.extension}</span>\n                    </div>\n                )}\n                <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium truncate\">{file.originalName}</p>\n                    <p className=\"text-xs text-gray-500\">\n                        {(file.size / 1024).toFixed(2)} KB • {file.previewType} • Uploaded {new Date(file.uploadedAt).toLocaleDateString()}\n                    </p>\n                </div>\n            </div>\n\n            {!selectionMode && (\n                <div className=\"flex gap-2 shrink-0\" onClick={(e) => e.stopPropagation()}>\n                    <Button\n                        size=\"sm\"\n                        variant=\"primary\"\n                        layout=\"plain\"\n                        leftIcon={DownloadIcon}\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            onDownload(file);\n                        }}\n                    />\n                    <Button\n                        size=\"sm\"\n                        variant=\"danger\"\n                        layout=\"plain\"\n                        leftIcon={TrashIcon}\n                        onClick={(e) => {\n                            e.stopPropagation();\n                            onDeleteRequest(file);\n                        }}\n                    />\n                </div>\n            )}\n        </div>\n    );\n};\n","import React from 'react';\nimport type { MediaFile } from '../../../types/media';\nimport { MediaListItem } from './MediaListItem';\n\ninterface MediaListViewProps {\n    files: MediaFile[];\n    selectionMode: boolean;\n    selectedFileId: string | null;\n    onFileClick: (file: MediaFile, index: number) => void;\n    onDownload: (file: MediaFile) => void;\n    onDeleteRequest: (file: MediaFile) => void;\n    onKeyDown: (e: React.KeyboardEvent, index: number) => void;\n    setFileRef: (index: number) => (el: HTMLDivElement | null) => void;\n}\n\nexport const MediaListView: React.FC<MediaListViewProps> = ({\n    files,\n    selectionMode,\n    selectedFileId,\n    onFileClick,\n    onDownload,\n    onDeleteRequest,\n    onKeyDown,\n    setFileRef,\n}) => {\n    return (\n        <div className=\"space-y-2\">\n            {files.map((file, index) => (\n                <MediaListItem\n                    key={file.id}\n                    file={file}\n                    index={index}\n                    selectionMode={selectionMode}\n                    isSelected={selectedFileId === file.id}\n                    onFileClick={onFileClick}\n                    onDownload={onDownload}\n                    onDeleteRequest={onDeleteRequest}\n                    onKeyDown={onKeyDown}\n                    setRef={setFileRef(index)}\n                />\n            ))}\n        </div>\n    );\n};\n","import React, { useEffect, useRef, useState } from 'react';\nimport type { MediaFile } from '../../../types/media';\nimport { getCurrentAuthToken } from '../../services/auth';\nimport { useMediaStore } from '../../services/media';\nimport { ConfirmationModal } from '../ConfirmationModal';\nimport FileUpload from '../FileUpload';\nimport { Button, Dropdown, TextInput } from '../index';\nimport { MediaGridView } from './MediaGridView';\nimport { MediaListView } from './MediaListView';\n\ntype ViewMode = 'grid' | 'tile';\n\ninterface MediaGridProps {\n    selectionMode?: boolean;\n    onFileSelect?: (file: MediaFile) => void;\n    fileType?: 'image' | 'video' | 'document';\n    showUpload?: boolean;\n    showViewToggle?: boolean;\n    showSearch?: boolean;\n    showFilter?: boolean;\n}\n\nconst allowedFileExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp', '.mp4', '.mov', '.avi', '.pdf', '.docx', '.doc', '.txt', '.csv'];\n\nconst maxFileSize = 50 * 1024 * 1024;\n\nconst fileTypeOptions = [\n    { label: 'All Types', value: '' },\n    { label: 'Images', value: 'image' },\n    { label: 'Videos', value: 'video' },\n    { label: 'Documents', value: 'document' },\n    { label: 'CSV', value: 'csv' },\n];\n\nexport const MediaGrid: React.FC<MediaGridProps> = ({\n    selectionMode = false,\n    onFileSelect,\n    fileType,\n    showUpload = false,\n    showViewToggle = false,\n    showSearch = true,\n    showFilter = false,\n}) => {\n    const { files, isLoading, loadFiles, deleteFile } = useMediaStore();\n    const [viewMode, setViewMode] = useState<ViewMode>('grid');\n    const [searchQuery, setSearchQuery] = useState('');\n    const [filterType, setFilterType] = useState<string>('');\n    const [selectedFileId, setSelectedFileId] = useState<string | null>(null);\n    const [fileToDelete, setFileToDelete] = useState<MediaFile | null>(null);\n    const [focusedIndex, setFocusedIndex] = useState(0);\n    const containerRef = useRef<HTMLDivElement>(null);\n    const fileRefs = useRef<(HTMLDivElement | null)[]>([]);\n\n    useEffect(() => {\n        loadFiles({ search: searchQuery, previewType: fileType || filterType });\n    }, [searchQuery, filterType, fileType]);\n\n    useEffect(() => {\n        fileRefs.current = fileRefs.current.slice(0, files.length);\n    }, [files]);\n\n    useEffect(() => {\n        if (focusedIndex >= 0 && focusedIndex < files.length) {\n            fileRefs.current[focusedIndex]?.focus();\n        }\n    }, [focusedIndex, files.length]);\n\n    const handleUploadComplete = () => {\n        loadFiles({ search: searchQuery, previewType: fileType || filterType });\n    };\n\n    const handleDeleteRequest = (file: MediaFile) => {\n        setFileToDelete(file);\n    };\n\n    const handleDeleteConfirm = async () => {\n        if (fileToDelete) {\n            await deleteFile(fileToDelete.id);\n            loadFiles({ search: searchQuery, previewType: fileType || filterType });\n            setFileToDelete(null);\n        }\n    };\n\n    const handleDownload = (file: MediaFile) => {\n        window.open(`/api/files/${file.id}/download`, '_blank');\n    };\n\n    const getColumnsCount = () => {\n        if (!containerRef.current) return 4;\n        const width = containerRef.current.offsetWidth;\n        if (width >= 1024) return 4;\n        if (width >= 768) return 3;\n        return 2;\n    };\n\n    const handleKeyDown = (e: React.KeyboardEvent, index: number) => {\n        const file = files[index];\n\n        switch (e.key) {\n            case 'ArrowRight':\n                e.preventDefault();\n                if (viewMode === 'grid') {\n                    setFocusedIndex(Math.min(files.length - 1, index + 1));\n                }\n                break;\n            case 'ArrowLeft':\n                e.preventDefault();\n                if (viewMode === 'grid') {\n                    setFocusedIndex(Math.max(0, index - 1));\n                }\n                break;\n            case 'ArrowDown':\n                e.preventDefault();\n                if (viewMode === 'grid') {\n                    const cols = getColumnsCount();\n                    const newIndex = Math.min(files.length - 1, index + cols);\n                    setFocusedIndex(newIndex);\n                } else {\n                    setFocusedIndex(Math.min(files.length - 1, index + 1));\n                }\n                break;\n            case 'ArrowUp':\n                e.preventDefault();\n                if (viewMode === 'grid') {\n                    const cols = getColumnsCount();\n                    const newIndex = Math.max(0, index - cols);\n                    setFocusedIndex(newIndex);\n                } else {\n                    setFocusedIndex(Math.max(0, index - 1));\n                }\n                break;\n            case 'Enter':\n                e.preventDefault();\n                if (selectionMode && onFileSelect) {\n                    onFileSelect(file);\n                } else {\n                    handleDownload(file);\n                }\n                break;\n            case 'Delete':\n                e.preventDefault();\n                if (!selectionMode) {\n                    handleDeleteRequest(file);\n                }\n                break;\n        }\n    };\n\n    const handleFileClick = (file: MediaFile, index: number) => {\n        setFocusedIndex(index);\n        if (selectionMode) {\n            setSelectedFileId(file.id);\n            if (onFileSelect) {\n                onFileSelect(file);\n            }\n        }\n    };\n\n    const setFileRef = (index: number) => (el: HTMLDivElement | null) => {\n        fileRefs.current[index] = el;\n    };\n\n    return (\n        <div className=\"space-y-6\">\n            {showUpload && (\n                <FileUpload\n                    uploadUrl=\"/api/files/upload\"\n                    getAuthToken={getCurrentAuthToken}\n                    allowedExtensions={allowedFileExtensions}\n                    maxFileSize={maxFileSize}\n                    onUploadComplete={handleUploadComplete}\n                />\n            )}\n\n            {(showSearch || showFilter || showViewToggle) && (\n                <div className=\"flex items-center gap-4\">\n                    {showSearch && (\n                        <TextInput\n                            placeholder=\"Search files...\"\n                            value={searchQuery}\n                            onChange={(e: any) => setSearchQuery(e.value)}\n                            className=\"flex-1\"\n                        />\n                    )}\n                    {showFilter && (\n                        <div className=\"min-w-50\">\n                            <Dropdown options={fileTypeOptions} value={filterType} onChange={(e: any) => setFilterType(e.value)} />\n                        </div>\n                    )}\n                    {showViewToggle && (\n                        <div className=\"flex gap-2 shrink-0\">\n                            <Button variant={viewMode === 'grid' ? 'primary' : 'default'} size=\"sm\" onClick={() => setViewMode('grid')}>\n                                Grid\n                            </Button>\n                            <Button variant={viewMode === 'tile' ? 'primary' : 'default'} size=\"sm\" onClick={() => setViewMode('tile')}>\n                                List\n                            </Button>\n                        </div>\n                    )}\n                </div>\n            )}\n\n            {isLoading ? (\n                <div className=\"text-center py-12\">Loading...</div>\n            ) : files.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500\">No files found</div>\n            ) : viewMode === 'grid' ? (\n                <MediaGridView\n                    files={files}\n                    selectionMode={selectionMode}\n                    selectedFileId={selectedFileId}\n                    onFileClick={handleFileClick}\n                    onDownload={handleDownload}\n                    onDeleteRequest={handleDeleteRequest}\n                    onKeyDown={handleKeyDown}\n                    setFileRef={setFileRef}\n                    containerRef={containerRef}\n                />\n            ) : (\n                <MediaListView\n                    files={files}\n                    selectionMode={selectionMode}\n                    selectedFileId={selectedFileId}\n                    onFileClick={handleFileClick}\n                    onDownload={handleDownload}\n                    onDeleteRequest={handleDeleteRequest}\n                    onKeyDown={handleKeyDown}\n                    setFileRef={setFileRef}\n                />\n            )}\n\n            <ConfirmationModal\n                isOpen={!!fileToDelete}\n                onClose={() => setFileToDelete(null)}\n                onConfirm={handleDeleteConfirm}\n                title=\"Delete File\"\n                message={`Are you sure you want to delete \"${fileToDelete?.originalName}\"? This action cannot be undone.`}\n                confirmText=\"Delete\"\n                variant=\"danger\"\n            />\n        </div>\n    );\n};\n"],"names":["useMediaStore","create","set","filters","query","url","response","ajax","error","fileId","ConfirmationModal","isOpen","onClose","onConfirm","title","message","confirmText","cancelText","variant","handleConfirm","jsx","Modal","jsxs","Button","validateFile","file","maxFileSize","allowedExtensions","fileExtension","uploadFileToServer","uploadUrl","authToken","onProgress","abortSignal","resolve","reject","formData","xhr","event","progress","FileUpload","getAuthToken","maxFiles","onUploadComplete","onUploadStart","onUploadProgress","onUploadError","className","children","isDragOver","setIsDragOver","useState","uploadingFiles","setUploadingFiles","fileInputRef","useRef","abortControllersRef","uploadFile","abortController","uploadingFile","prev","result","f","errorMessage","handleFiles","useCallback","files","fileArray","validFiles","errors","uploadPromises","uploadedFiles","cancelUpload","handleDragOver","e","handleDragLeave","handleDrop","handleFileInputChange","openFileDialog","classNames","UploadIcon","TimesIcon","MediaTile","index","selectionMode","isSelected","onFileClick","onDownload","onDeleteRequest","onKeyDown","setRef","DownloadIcon","TrashIcon","MediaGridView","selectedFileId","setFileRef","containerRef","MediaListItem","MediaListView","allowedFileExtensions","fileTypeOptions","MediaGrid","onFileSelect","fileType","showUpload","showViewToggle","showSearch","showFilter","isLoading","loadFiles","deleteFile","viewMode","setViewMode","searchQuery","setSearchQuery","filterType","setFilterType","setSelectedFileId","fileToDelete","setFileToDelete","focusedIndex","setFocusedIndex","fileRefs","useEffect","handleUploadComplete","handleDeleteRequest","handleDeleteConfirm","handleDownload","getColumnsCount","width","handleKeyDown","cols","newIndex","handleFileClick","el","getCurrentAuthToken","TextInput","Dropdown"],"mappings":"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"}