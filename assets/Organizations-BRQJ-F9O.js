import{n as E,c,r as l,j as e,T as j,B as m,M as I}from"../index.zPvR3SOO.js";const $=E(a=>({organizations:[],selectedOrganization:null,dashboardStats:null,isLoading:!1,error:null,total:0,loadOrganizations:async s=>{a({isLoading:!0,error:null});const r=new URLSearchParams;s?.limit&&r.append("limit",s.limit.toString()),s?.offset&&r.append("offset",s.offset.toString()),s?.search&&r.append("search",s.search);const n=await c.get(`/api/super-admin/organizations?${r.toString()}`);a({organizations:n.organizations,total:n.total,isLoading:!1})},loadOrganization:async s=>{a({isLoading:!0,error:null});const r=await c.get(`/api/super-admin/organizations/${s}`);a({selectedOrganization:r,isLoading:!1})},addCredits:async(s,r,n,d)=>{a({isLoading:!0,error:null}),await c.post(`/api/super-admin/organizations/${s}/credits`,{amount:r,expiresAt:n,description:d});const x=await c.get("/api/super-admin/organizations");a({organizations:x.organizations,total:x.total,isLoading:!1})},toggleOrganizationStatus:async(s,r)=>{a({isLoading:!0,error:null}),await c.patch(`/api/super-admin/organizations/${s}/status`,{isActive:r}),a(n=>({organizations:n.organizations.map(d=>d.id===s?{...d,isActive:r}:d),isLoading:!1}))},loadDashboardStats:async()=>{a({isLoading:!0,error:null});const s=await c.get("/api/super-admin/dashboard-stats");a({dashboardStats:s,isLoading:!1})},changePassword:async(s,r)=>{a({isLoading:!0,error:null}),await c.post("/api/super-admin/change-password",{currentPassword:s,newPassword:r}),a({isLoading:!1})},clearError:()=>a({error:null})})),i=a=>a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toLocaleString(),B=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=()=>{const{organizations:a,dashboardStats:s,isLoading:r,total:n,loadOrganizations:d,loadDashboardStats:x,addCredits:k,toggleOrganizationStatus:L}=$(),[f,O]=l.useState(""),[A,g]=l.useState(!1),[h,b]=l.useState(null),[o,N]=l.useState(""),[u,v]=l.useState(""),[w,C]=l.useState(""),[y,S]=l.useState(!1);l.useEffect(()=>{d(),x()},[]);const z=()=>{d({search:f})},D=async()=>{!h||!o||(S(!0),await k(h,parseInt(o),u?new Date(u):void 0,w||void 0),S(!1),g(!1),N(""),v(""),C(""),b(null))},M=t=>{b(t),g(!0)},p=a.find(t=>t.id===h);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Organizations"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage organizations and credits"})]})}),s&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Organizations"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:s.totalOrganizations}),e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[s.activeOrganizations," active"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Total Credits"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:i(s.totalCredits)}),e.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[i(s.totalLockedCredits)," locked"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Campaigns"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:i(s.totalCampaigns)}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[s.activeCampaigns," active"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Messages Sent"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:i(s.totalMessagesSent)})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(j,{value:f,onChange:t=>O(t.value),placeholder:"Search organizations...",onKeyDown:t=>t.key==="Enter"&&z()})}),e.jsx(m,{onClick:z,disabled:r,children:"Search"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organization"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credits"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Locked"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Available"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campaigns"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Messages"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:r?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"Loading..."})}):a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"No organizations found"})}):a.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.name}),t.website&&e.jsx("p",{className:"text-xs text-gray-500",children:t.website})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>L(t.id,!t.isActive),className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.isActive?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:t.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-900",children:i(t.creditBalance)}),e.jsx("td",{className:"px-4 py-3 text-right text-orange-600",children:i(t.lockedCredits)}),e.jsx("td",{className:"px-4 py-3 text-right text-green-600 font-medium",children:i(t.availableCredits)}),e.jsxs("td",{className:"px-4 py-3 text-right text-gray-600",children:[t.totalCampaigns,t.activeCampaigns>0&&e.jsxs("span",{className:"text-blue-600 ml-1",children:["(",t.activeCampaigns,")"]})]}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-600",children:i(t.totalMessagesSent)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:B(t.createdAt)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(m,{size:"sm",onClick:()=>M(t.id),children:"Add Credits"})})]},t.id))})]})}),n>a.length&&e.jsx("div",{className:"p-4 border-t border-gray-200 text-center",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",a.length," of ",n," organizations"]})})]}),e.jsx(I,{isOpen:A,onClose:()=>g(!1),title:"Add Credits",children:e.jsxs("div",{className:"space-y-4",children:[p&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"font-medium text-gray-900",children:p.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Current balance: ",e.jsx("span",{className:"font-medium",children:i(p.creditBalance)})," | ","Available: ",e.jsx("span",{className:"font-medium text-green-600",children:i(p.availableCredits)})]})]}),e.jsx(j,{label:"Credit Amount",type:"number",value:o,onChange:t=>N(t.value),placeholder:"Enter amount",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date (Optional)"}),e.jsx("input",{type:"date",value:u,onChange:t=>v(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty for credits that never expire"})]}),e.jsx(j,{label:"Description (Optional)",value:w,onChange:t=>C(t.value),placeholder:"e.g., Monthly allocation, Promotional credits"}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(m,{variant:"default",onClick:()=>g(!1),disabled:y,children:"Cancel"}),e.jsx(m,{onClick:D,disabled:!o||parseInt(o)<=0||y,children:y?"Adding...":"Add Credits"})]})]})})]})};export{T as Organizations,T as default};
//# sourceMappingURL=Organizations-BRQJ-F9O.js.map
